<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
   "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:c="http://java.sun.com/jsp/jstl/core"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:a4j="http://richfaces.org/a4j"
      xmlns:rich="http://richfaces.org/rich">

<ui:composition template="./template/layout.xhtml">
	<ui:define name="dialogs">
		<h:form id="addPopupForm">
			<rich:popupPanel id="addPopup"
							 width="800" 
							 height="300"
							 resizeable="true"
							 domElementAttachment="form"
							 onbeforeshow="#{rich:element('searchStringMSG')}.style.display='none';">
				<f:facet name="header">
					Add Movie
				</f:facet>
				<f:facet name="controls">
					<h:commandLink onclick="#{rich:component('addPopup')}.hide();return false;">
						<h:graphicImage library="img" name="cross-small.png"/>
					</h:commandLink>
				</f:facet>
				
				<h:inputText id="searchString" value="#{externalMovieSearchController.searchString}">
					<rich:validator/>
				</h:inputText>
				<h:commandButton value="search" action="#{externalMovieSearchController.search}" styleClass="default-margin-left">
					<f:ajax execute="searchString" render="movieSearchResult searchStringMSG"/>
				</h:commandButton>
				<rich:message id="searchStringMSG" for="searchString" styleClass="input-msg-inline"/>
				
				<br/><br/>
				
				<rich:dataTable id="movieSearchResult" 
								value="#{externalMovieSearchController.searchResult}" var="movie"
								noDataLabel="No Results!"
								styleClass="media-table">
		        	<rich:column>
		        		<f:facet name="header">Title</f:facet>
		        		<h:outputText value="#{movie.title}"/>
		        	</rich:column>
		        	<rich:column>
		        		<f:facet name="header">Description</f:facet>
		        		<h:outputText value="#{movie.description}"/>
		        	</rich:column>
		        	<rich:column>
		        		<f:facet name="header">Action</f:facet>
		        		<a4j:commandLink id="addMovie"
		        				action="#{editVideoController.persist( movie )}"
		        				render=":videoListForm:videoList"
		        				oncomplete="#{rich:component('addPopup')}.hide();">
		        			<h:graphicImage library="img" name="plus-button.png" alt="add"/>
		        		</a4j:commandLink>
		        	</rich:column>
		        </rich:dataTable>
			</rich:popupPanel>
		</h:form>
	</ui:define>
	
	<ui:define name="content">
	    <h:form id="videoListForm">
	        <rich:dataTable id="videoList" 
	        		value="#{videoListModel.videoList}"
	        		var="item"
	        		noDataLabel="No videos found ..."
	        		styleClass="media-table">
	        	<rich:column>
	        		<f:facet name="header">ID</f:facet>
	        		#{item.id}
	        	</rich:column>
	        	<rich:column>
	        		<f:facet name="header">Title</f:facet>
	        		#{item.title}
	        	</rich:column>
	        </rich:dataTable>
	        
	        <br/>
	        
	        <div style="text-align:right;">
	        	<h:commandButton 
	        		value="Add Item"
	        		onclick="#{rich:component('addPopupForm:addPopup')}.show();return false;"/>
	        </div>
	    </h:form>
    </ui:define>
</ui:composition>
    
</html>